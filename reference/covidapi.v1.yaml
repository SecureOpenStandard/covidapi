swagger: '2.0'
info:
  title: covidapi
  version: '1.0'
host: 'localhost:3000'
schemes:
  - https
produces:
  - application/json
consumes:
  - application/json
paths:
  '/status/{seedid}':
    get:
      summary: Your GET endpoint
      tags: []
      responses:
        '200':
          description: OK
          schema:
            type: object
            properties:
              message:
                type: string
                description: 'JWE message from an authority '
                pattern: '^[-A-Za-z0-9+=.]+$'
              tokenid:
                type: string
                description: 'signaling token id, utilized in the event of abuse '
            required:
              - tokenid
        '404':
          description: Not Found
          schema: {}
      operationId: get-status
      description: 'returns the current status '
    parameters:
      - type: string
        name: seedid
        in: path
        description: 'reference uuid used in encrypted ids '
        maxLength: 0
        minLength: 0
        pattern: '^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$'
        required: true
    delete:
      summary: ''
      operationId: delete-status
      responses:
        '202':
          description: Accepted
        '401':
          description: Unauthorized
          schema: {}
        '404':
          description: Not Found
          schema: {}
      description: 'clear status, may need a different token authorithy '
      parameters:
        - type: string
          in: header
          name: Authorization
          required: true
          description: deletion token
          pattern: '^[-A-Za-z0-9+=.]+$'
  /status:
    post:
      summary: ''
      operationId: post-status
      responses:
        '202':
          description: Accepted
        '401':
          description: Unauthorized
          schema:
            type: object
            properties: {}
      parameters:
        - type: string
          in: header
          name: Authorization
          required: true
          description: 'JWT one time validity! '
          pattern: '^[-A-Za-z0-9+=.]+$'
        - in: body
          name: body
          schema:
            type: object
            properties:
              ids:
                type: array
                description: JWEs the device saw
                minItems: 1
                items:
                  type: string
                  pattern: '^[-A-Za-z0-9+=.]+$'
              message:
                type: string
                pattern: '^[-A-Za-z0-9+=.]+$'
                description: JWE with a nice message from some authorithy
            required:
              - ids
          description: ''
      description: "commit your seen device ids \ncascade with other services -> tokenid based idempotency "
  /.well-known/jwks.json:
    get:
      summary: Your GET endpoint
      tags: []
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/jsonwebkeys'
      operationId: get-publickeys
      description: 'returns all well known public keys '
    parameters: []
  /token:
    get:
      summary: Your GET endpoint
      tags: []
      responses:
        '200':
          description: OK
          schema:
            type: string
            description: JWT-token ;)
            pattern: '^[-A-Za-z0-9+=.]+$'
        '500':
          description: Internal Server Error
          schema: {}
      operationId: get-token
      description: 'returns a simple token, spice it up with the surveilance and authority you like.'
definitions:
  jsonwebkeys:
    type: array
    description: list of keys
    items:
      type: object
      description: json web key
      properties:
        'n':
          type: string
          description: modulus
        e:
          type: string
          description: exponent
        kty:
          type: string
          description: ktype
        alg:
          type: string
          description: alorithm
        kid:
          type: string
          description: keyid
      required:
        - kty
        - kid
